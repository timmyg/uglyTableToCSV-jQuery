(function(e){e.UglyTableToCSV=function(t,n,r){var i=this;i.$el=e(t);i.el=t;i.$el.data("UglyTableToCSV",i);i.init=function(){i.options=e.extend({},e.UglyTableToCSV.defaultOptions,n)};i.createCSV=function(t){var n="";var s="%2C";var o="%0A";var u=i.options.columnsSliceRanges!=r;var a=new Array;if(i.options.columnNames!=r){n=i.options.columnNames;if(u){var f=i.options.columnsSliceRanges.split(";");for(var l=0;l<f.length;l++){a.push(f[l].split("-"))}}else{var c=i.options.columnNames.split(",").length;a.push(new Array(0,c))}}else{if(u){var f=i.options.columnsSliceRanges.split(";");for(var l=0;l<f.length;l++){a.push(f[l].split("-"))}}else{var c=e(i.$el.find(i.options.tableHeadersSelector+" th")).length;a.push(new Array(0,c))}for(var l=0;l<a.length;l++){e.each(i.$el.find(i.options.tableHeadersSelector+" th").slice(a[l][0],a[l][1]),function(){n+=e(this).text()+s})}}n+=o;var h;e.each(i.$el.find(i.options.tableRowsSelector),function(){for(var t=0;t<a.length;t++){e.each(e(this).find("td").slice(a[t][0],a[t][1]),function(){h="";h=e(this).text();if(h===""||h===r)h=e(this).children().attr("value");if(h!=r)h=h.replace(/,/g,"%20");if(h===r)h="";n+=h+s})}n+=o});n=n.replace(/ /g,"%20");var p=e('<a download="'+i.options.customFileName+'" href="data:application/csv;charset=utf-8,'+n+'"><input value="Download CSV" class="downloadCSV" type="button"></a>');if(e(".downloadCSV").length>0){e(".downloadCSV").remove()}p.insertAfter(i.$el)};i.init();i.createCSV()};e.UglyTableToCSV.defaultOptions={tableHeadersSelector:"thead th",columnsSliceRanges:undefined,tableRowsSelector:"tbody tr",customFileName:"uglyTableToCSVdownload.csv",columnNames:undefined};e.fn.uglyTableToCSV=function(t){return this.each(function(){new e.UglyTableToCSV(this,t)})}})(jQuery)